<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link href="../Content/bootstrap.min.css" rel="stylesheet" />
    <link href="jhBoggle.css" rel="stylesheet" />
    <title></title>
</head>
<body>
<div class="container-fluid">
<div class="row"></div>
<div class="row"></div>
<div class="row">
    <div class="col-md-12" align="center" >
        <table>
            <tr>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="0" data-boggle-col="0">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="0" data-boggle-col="1">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="0" data-boggle-col="2">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="0" data-boggle-col="3">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="0" data-boggle-col="4">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="0" data-boggle-col="5">?</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="1" data-boggle-col="0">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="1" data-boggle-col="1">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="1" data-boggle-col="2">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="1" data-boggle-col="3">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="1" data-boggle-col="4">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="1" data-boggle-col="5">?</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="2" data-boggle-col="0">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="2" data-boggle-col="1">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="2" data-boggle-col="2">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="2" data-boggle-col="3">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="2" data-boggle-col="4">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="2" data-boggle-col="5">?</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="3" data-boggle-col="0">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="3" data-boggle-col="1">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="3" data-boggle-col="2">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="3" data-boggle-col="3">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="3" data-boggle-col="4">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="3" data-boggle-col="5">?</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="4" data-boggle-col="0">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="4" data-boggle-col="1">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="4" data-boggle-col="2">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="4" data-boggle-col="3">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="4" data-boggle-col="4">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="4" data-boggle-col="5">?</div>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="5" data-boggle-col="0">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="5" data-boggle-col="1">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="5" data-boggle-col="2">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="5" data-boggle-col="3">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="5" data-boggle-col="4">?</div>
                    </div>
                </td>
                <td>
                    <div class="cube">
                        <div class="cubeLetter" data-boggle-row="5" data-boggle-col="5">?</div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</div>
<div class="row">
    <div class="col-md-12 form-inline" align="center">
        <br/>
        <div class="form-group">
            <input id="txtWordLookup" type="text" class="form-control" placeholder="Lookup in Oxford dictionary..."/>
        </div>
        <button id="btnLookup" type="button" class="btn btn-success">Search</button>
    </div>
</div>
</div>

<!-- Word Lookup Modal  -->
<div id="LookupModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title"><span id="LookupWord">LookupWord</span></h4>
            </div>
            <div class="modal-body">
                <p id="LookupResults"></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>

    </div>
</div>

<script src="../Scripts/jquery-1.12.4.min.js"></script>
<script src="../Scripts/bootstrap.min.js"></script>
<script src="../Scripts/moment.min.js"></script>
<script src="jhBoggle.js"></script>
<script>

    $(document).ready(function() {

        {
            var board =  jhBoggle.initialize();

            $(".cubeLetter").each(function () {
                var row = $(this).data("boggle-row");
                var col = $(this).data("boggle-col");
                $(this).text(board[row][col]);
            });
        }

        /*
         * Clicking a cube adds that letter to the word lookup textbox
         */
        $(".cubeLetter").click(function() {
            $("#txtWordLookup").val($("#txtWordLookup").val() + $(this).text());
        });

        /*
         * Lookup word in Oxford dictionary API
         */
        $("#btnLookup").click(function () {
            var wordId = $("#txtWordLookup").val();
            console.log("Looking up: " + wordId);

            $.ajax({
                    method: "POST",
                    url: "/Boggle/LookupWord",
                    data: { wordId: wordId }
                })
                .done(function (msg) {
                    console.log("Definitions recieved");
                    if (msg === "NOTFOUND") {
                        $("#LookupWord").text(wordId);
                        $("#LookupResults").text("Not found in the Oxford dictionary!");
                        console.log("Word not found in OxfordDictionary.com");
                    }
                    else {
                        $("#LookupResults").text("");

                        if (msg.indexOf("<") === 0) {
                            // This is a form of the word specified between initial <>
                            var rootWord = msg.substr(1, msg.indexOf(">")-1);
                            console.log("Form of the word: " + rootWord);
                            $("#LookupResults").append("<p><b>" + wordId + "</b> is a form of the word <b>" + rootWord + "</b></p> </br>");
                            msg = msg.substr(msg.indexOf(">") + 1);
                        }
                        // Parse and show correct word form and definitions
                        var defs = JSON.parse(msg);
                        // Get the correct case of the word and display as title
                        var word = defs.results[0].word;
                        $("#LookupWord").text(word);

                        for (var x = 0; x < defs.results[0].lexicalEntries.length; x++) {
                            $("#LookupResults").append("<p><u>" + defs.results[0].lexicalEntries[x].lexicalCategory + "</u>:</p>");
                            console.log("Category:" + defs.results[0].lexicalEntries[x].lexicalCategory);
                            $("#LookupResults").append("<ul>");
                            for (var s = 0; s < defs.results[0].lexicalEntries[x].entries[0].senses.length; s++) {
                                $("#LookupResults").append("<li>" + defs.results[0].lexicalEntries[x].entries[0].senses[s].definitions[0] + "</li>");
                                console.log(defs.results[0].lexicalEntries[x].entries[0].senses[s].definitions[0]);
                            }
                            $("#LookupResults").append("</ul></br>");
                        }
                    }
                    $("#LookupModal").modal("show");
                })
                .fail(function (jqXhr) {
                    $("#searchlist").html(jqXhr.responseText);
                });

            $("#txtWordLookup").val("");

        });
    });
</script>


</body>
</html>
